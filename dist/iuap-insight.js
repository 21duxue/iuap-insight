!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.uis=t():e.uis=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r);function o(e){var t,n,r,i,o,a,s,c,u,d,f=function(e,t){return e<<t|e>>>32-t},l=function(e){var t,n="";for(t=7;t>=0;t--)n+=(e>>>4*t&15).toString(16);return n},p=[],h=1732584193,m=4023233417,g=2562383102,w=271733878,v=3285377520,y=[];for(d=(e=decodeURI(encodeURIComponent(e))).length,n=0;n<d-3;n+=4)r=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),y.push(r);switch(3&d){case 0:n=2147483648;break;case 1:n=e.charCodeAt(d-1)<<24|8388608;break;case 2:n=e.charCodeAt(d-2)<<24|e.charCodeAt(d-1)<<16|32768;break;case 3:n=e.charCodeAt(d-3)<<24|e.charCodeAt(d-2)<<16|e.charCodeAt(d-1)<<8|128}for(y.push(n);14!=(15&y.length);)y.push(0);for(y.push(d>>>29),y.push(d<<3&4294967295),t=0;t<y.length;t+=16){for(n=0;n<16;n++)p[n]=y[t+n];for(n=16;n<=79;n++)p[n]=f(p[n-3]^p[n-8]^p[n-14]^p[n-16],1);for(i=h,o=m,a=g,s=w,c=v,n=0;n<=19;n++)u=f(i,5)+(o&a|~o&s)+c+p[n]+1518500249&4294967295,c=s,s=a,a=f(o,30),o=i,i=u;for(n=20;n<=39;n++)u=f(i,5)+(o^a^s)+c+p[n]+1859775393&4294967295,c=s,s=a,a=f(o,30),o=i,i=u;for(n=40;n<=59;n++)u=f(i,5)+(o&a|o&s|a&s)+c+p[n]+2400959708&4294967295,c=s,s=a,a=f(o,30),o=i,i=u;for(n=60;n<=79;n++)u=f(i,5)+(o^a^s)+c+p[n]+3395469782&4294967295,c=s,s=a,a=f(o,30),o=i,i=u;h=h+i&4294967295,m=m+o&4294967295,g=g+a&4294967295,w=w+s&4294967295,v=v+c&4294967295}return(u=l(h)+l(m)+l(g)+l(w)+l(v)).toLowerCase()}var a=function(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent))return!0},s=function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(t)&&(e=parseFloat(RegExp.$1))}return e},c=function(e){return e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},u=function(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g,t=arguments,n=0,r=t[n++],i=function(e,t,n,r){n||(n=" ");var i=e.length>=t?"":Array(1+t-e.length>>>0).join(n);return r?e+i:i+e},o=function(e,t,n,r,o,a){var s=r-e.length;return s>0&&(e=n||!o?i(e,r,a,n):e.slice(0,t.length)+i("",s,"0",!0)+e.slice(t.length)),e},a=function(e,t,n,r,a,s,c){var u=e>>>0;return e=(n=n&&u&&{2:"0b",8:"0",16:"0x"}[t]||"")+i(u.toString(t),s||0,"0",!1),o(e,n,r,a,c)},s=function(e,t,n,r,i,a){return null!=r&&(e=e.slice(0,r)),o(e,"",t,n,i,a)},c=function(e,r,c,u,d,f,l){var p,h,m,g,w;if("%%"==e)return"%";for(var v=!1,y="",k=!1,b=!1,_=" ",E=c.length,C=0;c&&C<E;C++)switch(c.charAt(C)){case" ":y=" ";break;case"+":y="+";break;case"-":v=!0;break;case"'":_=c.charAt(C+1);break;case"0":k=!0;break;case"#":b=!0}if((u=u?"*"==u?+t[n++]:"*"==u.charAt(0)?+t[u.slice(1,-1)]:+u:0)<0&&(u=-u,v=!0),!isFinite(u))throw new Error("sprintf: (minimum-)width must be finite");switch(f=f?"*"==f?+t[n++]:"*"==f.charAt(0)?+t[f.slice(1,-1)]:+f:"fFeE".indexOf(l)>-1?6:"d"==l?0:void 0,w=r?t[r.slice(0,-1)]:t[n++],l){case"s":return s(String(w),v,u,f,k,_);case"c":return s(String.fromCharCode(+w),v,u,f,k);case"b":return a(w,2,b,v,u,f,k);case"o":return a(w,8,b,v,u,f,k);case"x":return a(w,16,b,v,u,f,k);case"X":return a(w,16,b,v,u,f,k).toUpperCase();case"u":return a(w,10,b,v,u,f,k);case"i":case"d":return w=(h=(p=parseInt(+w,10))<0?"-":y)+i(String(Math.abs(p)),f,"0",!1),o(w,h,v,u,k);case"e":case"E":case"f":case"F":case"g":case"G":return h=(p=+w)<0?"-":y,m=["toExponential","toFixed","toPrecision"]["efg".indexOf(l.toLowerCase())],g=["toString","toUpperCase"]["eEfFgG".indexOf(l)%2],w=h+Math.abs(p)[m](f),o(w,h,v,u,k)[g]();default:return e}};return r.replace(e,c)},d=function(e){this.uis=e;var t=new Date,n=e.getOption("userId"),r=this.getValuesFromVisitorIdCookie(),i=this.loadReferrerAttributionCookie(),o=(i[0],i[1],i[2],i[3],document.characterSet||document.charset);o&&"utf-8"!==o.toLowerCase()||(o=null),this.properties={},this.id="",this.set("site_id",e.getOption("siteId")),this.set("client_ts",t.getTime()),n&&this.set("user_id",n),this.set("visitor_id",r.uuid),this.set("res",window.screen.width+" * "+window.screen.height),this.set("res_x",window.screen.width),this.set("res_y",window.screen.height),this.set("page_title",document.title);var a=e.urlFixup(document.domain,window.location.href,e.getReferrer()),s=decodeURIComponent(a[2]);this.set("url",window.location.href),s&&this.set("url_ref",s),this.set("host",window.location.host)};d.prototype={get:function(e){if(this.properties.hasOwnProperty(e))return this.properties[e]},set:function(e,t){this.properties[e]=t},setEventType:function(e){this.set("type",e)},setAction:function(e){this.set("action_id",e),window.action_id=e},getProperties:function(){return this.properties},merge:function(e){for(param in e)e.hasOwnProperty(param)&&this.set(param,e[param])},isSet:function(e){if(this.properties.hasOwnProperty(e))return!0},generateRandomUuid:function(){return o((navigator.userAgent||"")+(navigator.platform||"")+(new Date).getTime()+Math.random()).slice(0,16)},loadVisitorIdCookie:function(){var e,t=new Date,n=Math.round(t.getTime()/1e3),r=this.uis.getCookieName("id"),i=this.uis.getCookieName("visitorId"),o=UIS.getCookie(r),a=UIS.getCookie(i);return o?((e=o.split(".")).unshift("0"),e):(a||(a=this.generateRandomUuid(),UIS.setCookie(i,a)),e=["1",a,n,0,n,"",""])},getValuesFromVisitorIdCookie:function(){var e=this.loadVisitorIdCookie(),t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5];return UIS.isDefined(e[6])||(e[6]=""),{newVisitor:t,uuid:n,createTs:r,visitCount:i,currentVisitTs:o,lastVisitTs:a,lastEcommerceOrderTs:e[6]}},getVisitorId:function(){return this.getValuesFromVisitorIdCookie().uuid},loadReferrerAttributionCookie:function(){var e=UIS.getCookie(this.uis.getCookieName("ref"));if(e.length)try{if(e=JSON.parse(e),UIS.is_object(e))return e}catch(e){}return["","",0,""]}};var f=d,l={getTimes:function(e){var t=window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance;if(void 0===t)return!1;var n,r=t.timing,i={};if(e=e||{},r){if(e&&!e.simple)for(var o in r)n=r[o],!isNaN(parseFloat(n))&&isFinite(n)&&(i[o]=parseFloat(r[o]));if(void 0===i.firstPaint){var a=0;if("number"==typeof r.msFirstPaint)a=r.msFirstPaint,i.firstPaintTime=a-r.navigationStart;else if(void 0!==t.getEntriesByName){var s=t.getEntriesByName("first-paint");if(1===s.length){var c=s[0].startTime;a=t.timeOrigin+c,i.firstPaintTime=c}}e&&!e.simple&&(i.firstPaint=a)}i.loadTime=r.loadEventEnd-r.fetchStart,i.domReadyTime=r.domComplete-r.domInteractive,i.readyStart=r.fetchStart-r.navigationStart,i.redirectTime=r.redirectEnd-r.redirectStart,i.appcacheTime=r.domainLookupStart-r.fetchStart,i.unloadEventTime=r.unloadEventEnd-r.unloadEventStart,i.lookupDomainTime=r.domainLookupEnd-r.domainLookupStart,i.connectTime=r.connectEnd-r.connectStart,i.requestTime=r.responseEnd-r.requestStart,i.initDomTreeTime=r.domInteractive-r.responseEnd,i.loadEventTime=r.loadEventEnd-r.loadEventStart}return i},printTable:function(e){var t={},n=this.getTimes(e)||{};Object.keys(n).sort().forEach((function(e){t[e]={ms:n[e],s:+(n[e]/1e3).toFixed(2)}})),console.table(t)},printSimpleTable:function(){this.printTable({simple:!0})}};window.timing=window.timing||l;var p=l;function h(){this.config={trackerUrl:"",getRequestCharacterLimit:2e3,configCookieNamePrefix:"_pk_",siteId:"",userId:"",visitorId:""},this.isClickTrackingEnabled=!1,this.isTrackingJqueryAjax=!1,this.isTrackedClick=!1}h.isDebug=!1,h.debug=function(){this.isDebug&&window.console&&console.log.apply&&(window.console.firebug?console.log.apply(this,arguments):console.log.apply(console,arguments))},h.fn=h.prototype,h.fn.setOption=function(e,t){this.config[e]=t},h.fn.getOption=function(e){return this.config[e]},h.fn.getCookieName=function(e){return this.config.configCookieNamePrefix+e+"."+this.config.siteId},h.fn.prepareRequestData=function(e){var t,n,r={};for(var o in e){if(e.hasOwnProperty(o))if(n=e[o],"object"==i()(n)&&n instanceof Array)for(var a=e[o].length,s=0;s<a;s++)if((t=e[o][s])instanceof Array||null===t||"object"!=i()(t))r[u("%s[%s]",o,s)]=c(e[o][s]);else for(var d in e[o][s])r[u("%s[%s][%s]",o,s,d)]=c(e[o][s][d]);else r[u("%s",o)]=c(e[o])}return r},h.fn.prepareRequestDataForGet=function(e){e=this.prepareRequestData(e);var t="";for(var n in e)if(e.hasOwnProperty(n)){t+=u("%s=%s&",n,e[n])}return t},h.fn._parseRequestUrl=function(e){var t=this.prepareRequestDataForGet(e),n=this.getOption("trackerUrl");return-1===n.indexOf("?")?n+="?":n+="&",n+t},h.fn.getIframeDocument=function(e){var t=null;return e.contentDocument?t=e.contentDocument:e.contentWindow&&e.contentWindow.document?t=e.contentWindow.document:e.document&&(t=e.document),null==t&&h.debug("Document not found, append the parent element to the DOM before creating the IFrame"),t.open(),t.close(),t},h.fn.postFromIframe=function(e,t){var n=this.getOption("trackerUrl"),r=this.getIframeDocument(e),i="post_form"+Math.random();if(a()&&s()<9)var o=r.createElement('<form name="'+i+'"></form>');else(o=r.createElement("form")).setAttribute("name",i);for(var c in o.setAttribute("id",i),o.setAttribute("action",n),o.setAttribute("method","POST"),t)if(t.hasOwnProperty(c)){if(a()&&s()<9)var u=r.createElement("<input type='hidden' name='"+c+"' />");else(u=document.createElement("input")).setAttribute("name",c),u.setAttribute("type","hidden");u.setAttribute("value",t[c]),o.appendChild(u)}r.body.appendChild(o),r.forms[i].submit(),r.body.removeChild(o)},h.fn.generateHiddenIframe=function(e,t){var n="uis-tracker-post-iframe";if(a()&&s()<9)var r=document.createElement('<iframe name="'+n+'" src="about:blank" width="1" height="1"></iframe>');else(r=document.createElement("iframe")).setAttribute("name",n),r.setAttribute("src","about:blank"),r.setAttribute("width",1),r.setAttribute("height",1);r.setAttribute("class",n),r.setAttribute("style","border: none;");var i=this;null==e&&(e=document.body),e.appendChild(r);var o=setInterval((function(){i.getIframeDocument(r)&&(i.postFromIframe(r,t),clearInterval(o))}),1),c=setInterval((function(){e.removeChild(r),clearInterval(c)}),1e3)},h.fn.cdPost=function(e){var t="uis-tracker-post-container",n=(this.getOption("trackerUrl"),document.getElementById(t));if(!n){var r=document.createElement("div");r.setAttribute("id",t),document.body.appendChild(r),n=document.getElementById(t)}this.generateHiddenIframe(n,e)},h.fn._getTarget=function(e){var t=e.target||e.srcElement;return void 0===t||null==t?null:(3==t.nodeType&&(t=target.parentNode),t)},h.fn.findPosX=function(e){var t=0;if(e.offsetParent)for(;e.offsetParent;)t+=e.offsetLeft,e=e.offsetParent;else e.x&&(t+=e.x);return t},h.fn.findPosY=function(e){var t=0;if(e.offsetParent)for(;e.offsetParent;)t+=e.offsetTop,e=e.offsetParent;else e.y&&(t+=e.y);return t},h.fn.getReferrer=function(){var e="";try{e=window.top.document.referrer}catch(t){if(window.parent)try{e=window.parent.document.referrer}catch(t){e=""}}return""===e&&(e=document.referrer),e},h.fn.getParameter=function(e,t){var n=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e);return n?decodeURIComponent(n[1]):""},h.fn.getHostName=function(e){var t=new RegExp("^(?:(?:https?|ftp):)/*(?:[^@]+@)?([^:/#]+)").exec(e);return t?t[1]:e},h.fn.track=function(e,t,n){uis.setOption(t,n),this.clickEventHandler(e,!0)},h.fn.urlFixup=function(e,t,n){return e||(e=""),t||(t=""),"translate.googleusercontent.com"===e?(""===n&&(n=t),t=this.getParameter(t,"u"),e=this.getHostName(t)):"cc.bingj.com"!==e&&"webcache.googleusercontent.com"!==e&&"74.6."!==e.slice(0,5)||(t=document.links[0].href,e=this.getHostName(t)),[e,t,n]},h.fn.logEvent=function(e,t,n){!1===this.isTrackingJqueryAjax&&window.$&&window.$.ajax&&this.trackJqueryAjax(window.$);var r=this._parseRequestUrl(e),i=this.getOption("getRequestCharacterLimit");if(r.length>i){var o=this.prepareRequestData(e);this.cdPost(o)}else{h.debug("url : %s",r);var a=new Image(1,1);a.onLoad=function(){},a.src=r,h.debug("Inserted web bug for %s",e.event_type)}n&&"function"==typeof n&&n()},h.fn.clickEventHandler=function(e,t){if(e=e||window.event,this.isTrackedClick)this.isTrackedClick=!1;else{this.isTrackedClick=!0,t||(this.isTrackedClick=!1);var n=new f(this);n.setEventType("click");var r=this._getTarget(e),i=n.generateRandomUuid();if(n.setAction(i),r.hasOwnProperty&&r.hasOwnProperty("value")&&r.value.length>0&&r.value,console.log("isComstomClickText:"+t),t){var o=uis.getOption("click_text");n.set("click_text",o)}else n.set("click_text",r.innerText);r.hasOwnProperty&&r.hasOwnProperty("name")&&r.name.length>0&&n.set("click_name",r.name),r.hasOwnProperty&&r.hasOwnProperty("value")&&r.value.length>0&&n.set("click_value",r.value),r.hasOwnProperty&&r.hasOwnProperty("id")&&r.id.length>0&&n.set("click_id",r.id),r.className&&r.className.length>0&&n.set("click_class",r.className),n.set("click_tag",h.strtolower(r.tagName)),n.set("click_pos_x",this.findPosX(r)),n.set("click_pos_y",this.findPosY(r)),this.logEvent(n.getProperties())}},h.fn.bindClickEvents=function(e){if(!this.isClickTrackingEnabled){var t=this;window.addEventListener?window.addEventListener("click",(function(n){t.clickEventHandler(n,e)}),!1):window.attachEvent&&document.attachEvent("onclick",(function(n){t.clickEventHandler(n,e)})),this.isClickTrackingEnabled=!0}},h.fn.trackClicks=function(){this.bindClickEvents(!1)},h.fn.trackJqueryAjax=function(e){var t=this,n=e.ajax;e.ajax=function(r,o){"object"===i()(r)&&(o=r,r=void 0);var a,s=(o=o||{}).complete,c=o.beforeSend,u=o.dataFilter,d=(new Date).getTime(),l=o.url;return o.beforeSend=function(t){t.setRequestHeader("Action-Id",window.action_id),e.isFunction(c)&&c.apply(this,arguments)},o.dataFilter=function(t,n){return a=(new Date).getTime(),e.isFunction(u)?u.apply(this,arguments):t},o.complete=function(n,r,i){var o=n.getResponseHeader("txID"),c=n.getResponseHeader("Action-Id"),u=n.getResponseHeader("Content-Length");e.isFunction(s)&&s.apply(this,arguments);var p=(new Date).getTime(),h=a-d,m=p-d,g=new f(t);g.setEventType("ajax"),g.setAction(c),g.set("ajax_id",o),g.set("content_length",u||0),g.set("ajax_tm",h||0),g.set("ajax_tm_cb",m||0),g.set("url_ajax",l),t.logEvent(g.getProperties())},n(r,o)},this.isTrackingJqueryAjax=!0},h.fn._trackRouterEvent=function(e){var t=this.urlFixup(document.domain,window.location.href,this.getReferrer()),n=decodeURIComponent(t[2]);e.setAction(window.action_id),e.set("url",window.location.href),n&&e.set("url_ref",n)},h.fn.trackRouter=function(){var e=this,t=function(t){var n=new f(e);n.setEventType("page_route"),e._trackRouterEvent(n),e.logEvent(n.getProperties())},n=function(t){var n=new f(e);n.setEventType("page_route"),e._trackRouterEvent(n),e.logEvent(n.getProperties())};void 0!==window.onhashchange&&(window.addEventListener?window.addEventListener("hashchange",t,!1):window.attachEvent&&window.attachEvent("onhashchange",t)),void 0!==window.onpopstate&&(window.addEventListener?window.addEventListener("popstate",n,!1):window.attachEvent&&window.attachEvent("onpopstate",n)),window.history.pushState&&(window.history._pushState=window.history.pushState,window.history.pushState=function(t,n,r){window.history._pushState(t,n,r);var i=new f(e);i.setEventType("page_route"),e._trackRouterEvent(i),e.logEvent(i.getProperties())}),window.history.replaceState&&(window.history._replaceState=window.history.replaceState,window.history.replaceState=function(t,n,r){window.history._replaceState(t,n,r);var i=new f(e);i.setEventType("page_route"),e._trackRouterEvent(i),e.logEvent(i.getProperties())})},h.fn.trackPageLoad=function(){var e=this,t=new f(this),n=p.getTimes();if(n.loadTime>0){var r=t.generateRandomUuid();t.setEventType("page_load"),t.setAction(r),t.set("t_unload",n.t_unload||0),t.set("t_redirect",n.t_redirect||0),t.set("t_dns",n.t_dns||0),t.set("t_tcp",n.t_tcp||0),t.set("t_request",n.t_request||0),t.set("t_response",n.t_response||0),t.set("t_paint",n.t_paint||0),t.set("t_dom",n.t_dom||0),t.set("t_domready",n.t_domready||0),t.set("t_load",n.t_load||0),t.set("t_onload",n.t_onload||0),t.set("t_white",n.t_white||0),t.set("t_all",n.t_all||0),t.set("ajax_tm",n.t_all||0),this.logEvent(t.getProperties())}else setTimeout((function(){e.trackPageLoad()}),400)},h.fn.log=function(e){if("object"==i()(e)){var t=new f(this);for(var n in t.setEventType("custom"),e)0==n.indexOf("ext")&&t.set(n,e[n]);this.logEvent(t.getProperties())}},h.fn.trackError=function(){window.onerror=function(e,t,n,r,i){if("Script error."!=e&&!t)return!0;setTimeout((function(){var e={};if(r=r||window.event&&window.event.errorCharacter||0,e.url=t,e.line=n,e.col=r,i&&i.stack)e.msg=i.stack.toString();else if(arguments.callee){for(var o=[],a=arguments.callee.caller,s=3;a&&--s>0&&(o.push(a.toString()),a!==a.caller);)a=a.caller;o=o.join(","),e.msg=o}var c=window.uis||new h,u=new f(c);u.setEventType("jserror"),u.set("error_js",e.url),u.set("error_line",e.line),u.set("error_col",e.col),u.set("error_msg",e.msg.toString()),c.logEvent(u.getProperties())}),0)}},h.fn.start=function(e){e.trackerUrl&&this.setOption("trackerUrl",e.trackerUrl),e.userId&&this.setOption("userId",e.userId),e.siteId&&this.setOption("siteId",e.siteId),this.trackClicks(),this.trackRouter(),this.trackPageLoad(),this.trackError(),window.$&&window.$.ajax&&this.trackJqueryAjax(window.$)};var m=new h;window.uis=window.uis||{};t.default=m}])}));
//# sourceMappingURL=iuap-insight.js.map